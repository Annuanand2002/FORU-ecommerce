<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header text-center" style="background-color: rgb(228, 178, 117); color: white;">
                    <h2 class="mb-0">Edit Product</h2>
                </div>
                <div class="card-body" style="background-color: #f8f9fa;">
                    <form id="editProductForm" action="/admin/edit-product/{{product._id}}" method="post"
                        enctype="multipart/form-data">

                        <div class="mb-3">
                            <label for="name" class="form-label" style="color: #333;">Product Name:</label>
                            <input type="text" name="name" id="name" class="form-control" value="{{product.name}}" required>
                            <small id="nameError" class="text-danger"></small>
                        </div>

                        <div class="mb-3">
                            <label for="price" class="form-label" style="color: #333;">Price:</label>
                            <input type="number" name="price" id="price" class="form-control" value="{{product.price}}" required>
                            <small id="priceError" class="text-danger"></small>
                        </div>

                        <div class="mb-3">
                            <label for="category" class="form-label" style="color: #333;">Category:</label>
                            <select name="category" class="form-control" required>
                                <option value="" disabled selected>Select category</option>
                                {{#each categories}}
                                <option value="{{this.name}}"
                                    {{#ifEquals this.name product.category}}selected{{/ifEquals}}>
                                    {{this.name}}</option>
                                {{/each}}
                            </select>
                            <small id="categoryError" class="text-danger"></small>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label" style="color: #333;">Product
                                Description:</label>
                            <textarea name="description" id="description" class="form-control" rows="4"
                                required>{{product.description}}</textarea>
                            <small id="descriptionError" class="text-danger"></small>
                        </div>

                        <div class="mb-3">
                            <label for="images" class="form-label" style="color: #333;">Current Images:</.label>
                            <div id="images-container">
                                {{#each product.images}}
                                <div class="image-thumbnail"
                                    style="display: inline-block; margin-right: 10px;">
                                    <img src="{{this}}" alt="Product Image" class="img-thumbnail"
                                        style="width: 100px; height: auto;">
                                </div>
                                {{/each}}
                            </div>
                            <label for="images" class="form-label" style="color: #333;">New Images
                                (optional):</label>
                            <input type="file" name="images" id="images" class="form-control" multiple>
                        </div>

                        <div class="mb-3">
                            <label for="sizes" class="form-label" style="color: #333;">Product Sizes:</label>
                            <div id="sizes-container">
                                {{#each product.sizes}}
                                <div class="size-entry mb-2 d-flex align-items-center">
                                    <input type="text" name="sizeName[]" class="form-control me-2"
                                        value="{{this.size}}" readonly />
                                    <input type="number" name="sizeQuantity[]" class="form-control me-2"
                                        value="{{this.quantity}}" min="1" />
                                    <button type="button" class="btn btn-danger btn-sm remove-size">Remove</button>
                                </div>
                                {{/each}}
                            </div>
                            <button type="button" class="btn btn-sm mt-2" id="addSizeBtn"
                                style="background-color:rgb(228, 178, 117);color:white;">Add New
                                Size</button>
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" name="bestSeller" id="bestSeller" class="form-check-input"
                                {{#if product.bestSeller}}checked{{/if}}>
                            <label for="bestSeller" class="form-check-label" style="color: #333;">Bestseller</label>
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" name="latestCollection" id="latestCollection"
                                class="form-check-input" {{#if product.latestCollection}}checked{{/if}}>
                            <label for="latestCollection" class="form-check-label"
                                style="color: #333;">Latest Collection</label>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn"
                                style="background-color:rgb(228, 178, 117);color:white">Submit</button>
                            <a href="/admin/products" class="btn"
                                style="background-color:rgb(228, 178, 117);color:white">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const addSizeBtn = document.getElementById('addSizeBtn');
        const sizesContainer = document.getElementById('sizes-container');

        addSizeBtn.addEventListener('click', function () {
            const newSizeHTML = `
      <div class="size-entry mb-2 d-flex align-items-center">
        <input type="text" name="sizeName[]" class="form-control me-2" placeholder="Size Name" required/>
        <input type="number" name="sizeQuantity[]" class="form-control me-2" placeholder="Quantity" min="0" required/>
        <button type="button" class="btn btn-danger btn-sm remove-size">Remove</button>
      </div>
    `;
            sizesContainer.insertAdjacentHTML('beforeend', newSizeHTML);
        });

        sizesContainer.addEventListener('click', function (event) {
            if (event.target.classList.contains('remove-size')) {
                event.target.parentNode.remove();
            }
        });
    });
</script>



